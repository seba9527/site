<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2018校赛逆向出题思路 | 吾行吾道，虽远必至</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/icons/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
    <meta name="description" content="分享zjgcjy的个人笔记、读书论文、学习知识">
    <meta name="author" content="zjgcjy">
    <meta name="keywords" content="blog, document, zjgcjy">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/android-chrome-192x192.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.8cd36500.css" as="style"><link rel="preload" href="/assets/js/app.c384680d.js" as="script"><link rel="preload" href="/assets/js/9.1b3f6a17.js" as="script"><link rel="preload" href="/assets/js/3.3518c87f.js" as="script"><link rel="preload" href="/assets/js/49.bacdf275.js" as="script"><link rel="preload" href="/assets/js/5.94903e8d.js" as="script"><link rel="prefetch" href="/assets/js/10.1a5906bb.js"><link rel="prefetch" href="/assets/js/100.00c6e1e3.js"><link rel="prefetch" href="/assets/js/101.7e883d09.js"><link rel="prefetch" href="/assets/js/102.339888b6.js"><link rel="prefetch" href="/assets/js/103.0763c9bc.js"><link rel="prefetch" href="/assets/js/104.31258c8c.js"><link rel="prefetch" href="/assets/js/105.51209ff5.js"><link rel="prefetch" href="/assets/js/106.f59ceeb8.js"><link rel="prefetch" href="/assets/js/107.d73ab3b3.js"><link rel="prefetch" href="/assets/js/108.cc766282.js"><link rel="prefetch" href="/assets/js/109.0ddc53ad.js"><link rel="prefetch" href="/assets/js/11.64107df6.js"><link rel="prefetch" href="/assets/js/110.c0573dec.js"><link rel="prefetch" href="/assets/js/111.6945a4b3.js"><link rel="prefetch" href="/assets/js/112.c38dbbb3.js"><link rel="prefetch" href="/assets/js/113.b02a5703.js"><link rel="prefetch" href="/assets/js/114.37b1df4b.js"><link rel="prefetch" href="/assets/js/115.2a42f807.js"><link rel="prefetch" href="/assets/js/116.a112978e.js"><link rel="prefetch" href="/assets/js/117.b62e65bc.js"><link rel="prefetch" href="/assets/js/118.67aa5d8f.js"><link rel="prefetch" href="/assets/js/119.7e4f50e4.js"><link rel="prefetch" href="/assets/js/12.7bb014af.js"><link rel="prefetch" href="/assets/js/120.f82a31d8.js"><link rel="prefetch" href="/assets/js/121.de488f8a.js"><link rel="prefetch" href="/assets/js/122.5f4c1f92.js"><link rel="prefetch" href="/assets/js/123.6bcd6ea9.js"><link rel="prefetch" href="/assets/js/124.ea16ca43.js"><link rel="prefetch" href="/assets/js/125.96ff8654.js"><link rel="prefetch" href="/assets/js/126.29c1fb5a.js"><link rel="prefetch" href="/assets/js/127.3805f2dc.js"><link rel="prefetch" href="/assets/js/128.4f2a158f.js"><link rel="prefetch" href="/assets/js/129.2b27bc8c.js"><link rel="prefetch" href="/assets/js/13.7499eb06.js"><link rel="prefetch" href="/assets/js/130.2042bff6.js"><link rel="prefetch" href="/assets/js/131.b12a2834.js"><link rel="prefetch" href="/assets/js/132.65586f23.js"><link rel="prefetch" href="/assets/js/133.4e4a4761.js"><link rel="prefetch" href="/assets/js/134.e7387acf.js"><link rel="prefetch" href="/assets/js/135.e525adeb.js"><link rel="prefetch" href="/assets/js/136.9b44c01b.js"><link rel="prefetch" href="/assets/js/137.73a521ab.js"><link rel="prefetch" href="/assets/js/138.01d88b91.js"><link rel="prefetch" href="/assets/js/139.593c5bde.js"><link rel="prefetch" href="/assets/js/14.6a5c3df4.js"><link rel="prefetch" href="/assets/js/140.cd2f417b.js"><link rel="prefetch" href="/assets/js/141.9e1d9a38.js"><link rel="prefetch" href="/assets/js/142.2362a1ce.js"><link rel="prefetch" href="/assets/js/143.34bb21b4.js"><link rel="prefetch" href="/assets/js/144.bb19885b.js"><link rel="prefetch" href="/assets/js/145.0132dde5.js"><link rel="prefetch" href="/assets/js/146.f0015782.js"><link rel="prefetch" href="/assets/js/147.f68dcd61.js"><link rel="prefetch" href="/assets/js/148.69705401.js"><link rel="prefetch" href="/assets/js/149.1a46b364.js"><link rel="prefetch" href="/assets/js/15.163b28cd.js"><link rel="prefetch" href="/assets/js/150.090dc22b.js"><link rel="prefetch" href="/assets/js/151.e1535643.js"><link rel="prefetch" href="/assets/js/152.ce6c4f42.js"><link rel="prefetch" href="/assets/js/153.2d0fde52.js"><link rel="prefetch" href="/assets/js/154.a1a56ffc.js"><link rel="prefetch" href="/assets/js/155.d3b97a96.js"><link rel="prefetch" href="/assets/js/156.2f9631fd.js"><link rel="prefetch" href="/assets/js/157.fe36f162.js"><link rel="prefetch" href="/assets/js/158.e7b1acd4.js"><link rel="prefetch" href="/assets/js/159.e8a79b82.js"><link rel="prefetch" href="/assets/js/16.f8b680fe.js"><link rel="prefetch" href="/assets/js/160.6d2a5337.js"><link rel="prefetch" href="/assets/js/161.6614cae2.js"><link rel="prefetch" href="/assets/js/162.f83a8847.js"><link rel="prefetch" href="/assets/js/163.1e4fd9a9.js"><link rel="prefetch" href="/assets/js/164.91be2ab7.js"><link rel="prefetch" href="/assets/js/165.b1498e01.js"><link rel="prefetch" href="/assets/js/166.8506f7d9.js"><link rel="prefetch" href="/assets/js/167.47f64995.js"><link rel="prefetch" href="/assets/js/168.14797502.js"><link rel="prefetch" href="/assets/js/169.e6f94d79.js"><link rel="prefetch" href="/assets/js/17.eb42e0a2.js"><link rel="prefetch" href="/assets/js/170.52cbfd61.js"><link rel="prefetch" href="/assets/js/171.a5fb47d3.js"><link rel="prefetch" href="/assets/js/172.d8cacff7.js"><link rel="prefetch" href="/assets/js/173.9b2424d9.js"><link rel="prefetch" href="/assets/js/174.47a63ae1.js"><link rel="prefetch" href="/assets/js/175.bd05ae48.js"><link rel="prefetch" href="/assets/js/176.32d3076b.js"><link rel="prefetch" href="/assets/js/177.ae758bda.js"><link rel="prefetch" href="/assets/js/178.8eecf14f.js"><link rel="prefetch" href="/assets/js/179.7540acac.js"><link rel="prefetch" href="/assets/js/18.5fe4133b.js"><link rel="prefetch" href="/assets/js/180.fcc4e886.js"><link rel="prefetch" href="/assets/js/181.77cc09e3.js"><link rel="prefetch" href="/assets/js/182.4a4e5ab7.js"><link rel="prefetch" href="/assets/js/183.54b5696e.js"><link rel="prefetch" href="/assets/js/184.e26d4934.js"><link rel="prefetch" href="/assets/js/185.662d3552.js"><link rel="prefetch" href="/assets/js/186.dc7e943f.js"><link rel="prefetch" href="/assets/js/187.c9e32203.js"><link rel="prefetch" href="/assets/js/188.3ef9817d.js"><link rel="prefetch" href="/assets/js/19.9c32c575.js"><link rel="prefetch" href="/assets/js/20.15001b89.js"><link rel="prefetch" href="/assets/js/21.0e62a18e.js"><link rel="prefetch" href="/assets/js/22.c18b5d79.js"><link rel="prefetch" href="/assets/js/23.68f9b424.js"><link rel="prefetch" href="/assets/js/24.6f1d9858.js"><link rel="prefetch" href="/assets/js/25.418e854a.js"><link rel="prefetch" href="/assets/js/26.f113b400.js"><link rel="prefetch" href="/assets/js/27.2b995202.js"><link rel="prefetch" href="/assets/js/28.9f262b84.js"><link rel="prefetch" href="/assets/js/29.2f569d21.js"><link rel="prefetch" href="/assets/js/30.a9d1d7a1.js"><link rel="prefetch" href="/assets/js/31.e69b5d0e.js"><link rel="prefetch" href="/assets/js/32.c6f6c418.js"><link rel="prefetch" href="/assets/js/33.bc2c3656.js"><link rel="prefetch" href="/assets/js/34.afdf04e5.js"><link rel="prefetch" href="/assets/js/35.458fb446.js"><link rel="prefetch" href="/assets/js/36.070c9190.js"><link rel="prefetch" href="/assets/js/37.c2b09938.js"><link rel="prefetch" href="/assets/js/38.95406bd8.js"><link rel="prefetch" href="/assets/js/39.431c8377.js"><link rel="prefetch" href="/assets/js/4.e41971a1.js"><link rel="prefetch" href="/assets/js/40.9d03e5ae.js"><link rel="prefetch" href="/assets/js/41.609a68e8.js"><link rel="prefetch" href="/assets/js/42.1e8d11a0.js"><link rel="prefetch" href="/assets/js/43.319dfdfd.js"><link rel="prefetch" href="/assets/js/44.0d133487.js"><link rel="prefetch" href="/assets/js/45.f939f98a.js"><link rel="prefetch" href="/assets/js/46.3a338253.js"><link rel="prefetch" href="/assets/js/47.2262fb1e.js"><link rel="prefetch" href="/assets/js/48.5d898ee7.js"><link rel="prefetch" href="/assets/js/50.acbc97ed.js"><link rel="prefetch" href="/assets/js/51.fe9f8430.js"><link rel="prefetch" href="/assets/js/52.7aa1aec8.js"><link rel="prefetch" href="/assets/js/53.63e90c71.js"><link rel="prefetch" href="/assets/js/54.0a5041b8.js"><link rel="prefetch" href="/assets/js/55.e10a8046.js"><link rel="prefetch" href="/assets/js/56.8a88b4e7.js"><link rel="prefetch" href="/assets/js/57.018df150.js"><link rel="prefetch" href="/assets/js/58.c03ab36e.js"><link rel="prefetch" href="/assets/js/59.bbf3f7a1.js"><link rel="prefetch" href="/assets/js/6.d3ab00b8.js"><link rel="prefetch" href="/assets/js/60.2ef52a58.js"><link rel="prefetch" href="/assets/js/61.b2841853.js"><link rel="prefetch" href="/assets/js/62.7b1910c8.js"><link rel="prefetch" href="/assets/js/63.a6e5beda.js"><link rel="prefetch" href="/assets/js/64.50d6c4dc.js"><link rel="prefetch" href="/assets/js/65.0e1eddf3.js"><link rel="prefetch" href="/assets/js/66.2bccc80c.js"><link rel="prefetch" href="/assets/js/67.cd0d1953.js"><link rel="prefetch" href="/assets/js/68.42aac4a3.js"><link rel="prefetch" href="/assets/js/69.0946a4e8.js"><link rel="prefetch" href="/assets/js/7.9393ab77.js"><link rel="prefetch" href="/assets/js/70.b5f967ff.js"><link rel="prefetch" href="/assets/js/71.e6c98889.js"><link rel="prefetch" href="/assets/js/72.373fea3c.js"><link rel="prefetch" href="/assets/js/73.3d77c29d.js"><link rel="prefetch" href="/assets/js/74.6d221a25.js"><link rel="prefetch" href="/assets/js/75.c9c4090b.js"><link rel="prefetch" href="/assets/js/76.293e5931.js"><link rel="prefetch" href="/assets/js/77.e7ef44b9.js"><link rel="prefetch" href="/assets/js/78.ebc5cbe6.js"><link rel="prefetch" href="/assets/js/79.2b2e1dbc.js"><link rel="prefetch" href="/assets/js/8.1401e2ee.js"><link rel="prefetch" href="/assets/js/80.0e43dc06.js"><link rel="prefetch" href="/assets/js/81.349305b1.js"><link rel="prefetch" href="/assets/js/82.dc640347.js"><link rel="prefetch" href="/assets/js/83.6c57bc58.js"><link rel="prefetch" href="/assets/js/84.2b7772d2.js"><link rel="prefetch" href="/assets/js/85.a3a2d2c2.js"><link rel="prefetch" href="/assets/js/86.0209d58b.js"><link rel="prefetch" href="/assets/js/87.ba789b20.js"><link rel="prefetch" href="/assets/js/88.baf1af1d.js"><link rel="prefetch" href="/assets/js/89.c7b2464d.js"><link rel="prefetch" href="/assets/js/90.99bf6bdb.js"><link rel="prefetch" href="/assets/js/91.70584638.js"><link rel="prefetch" href="/assets/js/92.0fc77a4b.js"><link rel="prefetch" href="/assets/js/93.e1191b15.js"><link rel="prefetch" href="/assets/js/94.1f8a1cb3.js"><link rel="prefetch" href="/assets/js/95.762ec96e.js"><link rel="prefetch" href="/assets/js/96.181592dd.js"><link rel="prefetch" href="/assets/js/97.087c8753.js"><link rel="prefetch" href="/assets/js/98.7592c45a.js"><link rel="prefetch" href="/assets/js/99.c9bc6084.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.8a9a8dc9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8cd36500.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/nav-logo.png" alt="吾行吾道，虽远必至" class="logo"> <span class="site-name can-hide">吾行吾道，虽远必至</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          论文
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/papers/academic_papers/" class="nav-link">
  学术论文
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/papers/other_papers/" class="nav-link">
  其他文章
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CTF" class="dropdown-title"><span class="title">CTF</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          CTF笔记
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/reverse/" class="nav-link">
  Reverse
</a></li><li class="dropdown-subitem"><a href="/ctf/pwn/" class="nav-link">
  Pwn
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/ctf/writeup/" class="nav-link router-link-active">
  writeup
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/languages/cplusplus/" class="nav-link">
  C++
</a></li><li class="dropdown-item"><!----> <a href="/languages/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/languages/android/" class="nav-link">
  Android
</a></li><li class="dropdown-item"><!----> <a href="/languages/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/languages/rust/" class="nav-link">
  Rust
</a></li><li class="dropdown-item"><!----> <a href="/languages/vc/" class="nav-link">
  VC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具与项目" class="dropdown-title"><span class="title">工具与项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/" class="nav-link">
  工具
</a></li><li class="dropdown-item"><!----> <a href="/projects/" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="杂谈" class="dropdown-title"><span class="title">杂谈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/diary/" class="nav-link">
  日记
</a></li><li class="dropdown-item"><!----> <a href="/others/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多vuepress" class="dropdown-title"><span class="title">vuepress</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/guide/" class="nav-link">
  指南
</a></li><li class="dropdown-subitem"><a href="/vue/config/" class="nav-link">
  配置
</a></li></ul></li><li class="dropdown-item"><h4>
          主题与插件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/plugin/" class="nav-link">
  插件
</a></li><li class="dropdown-subitem"><a href="/vue/theme/" class="nav-link">
  主题
</a></li></ul></li><li class="dropdown-item"><h4>
          API
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/api/cli.html" class="nav-link">
  CLI
</a></li><li class="dropdown-subitem"><a href="/vue/api/node.html" class="nav-link">
  Node
</a></li></ul></li><li class="dropdown-item"><h4>
          开发指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/miscellaneous/local-development.html" class="nav-link">
  本地开发
</a></li><li class="dropdown-subitem"><a href="/vue/miscellaneous/design-concepts.html" class="nav-link">
  设计理念
</a></li><li class="dropdown-subitem"><a href="/vue/faq/" class="nav-link">
  FAQ
</a></li><li class="dropdown-subitem"><a href="/vue/miscellaneous/glossary.html" class="nav-link">
  术语
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about.html" class="nav-link">
  关于我
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/zjgcjy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          论文
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/papers/academic_papers/" class="nav-link">
  学术论文
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/papers/other_papers/" class="nav-link">
  其他文章
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CTF" class="dropdown-title"><span class="title">CTF</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          CTF笔记
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/reverse/" class="nav-link">
  Reverse
</a></li><li class="dropdown-subitem"><a href="/ctf/pwn/" class="nav-link">
  Pwn
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/ctf/writeup/" class="nav-link router-link-active">
  writeup
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/languages/cplusplus/" class="nav-link">
  C++
</a></li><li class="dropdown-item"><!----> <a href="/languages/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/languages/android/" class="nav-link">
  Android
</a></li><li class="dropdown-item"><!----> <a href="/languages/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/languages/rust/" class="nav-link">
  Rust
</a></li><li class="dropdown-item"><!----> <a href="/languages/vc/" class="nav-link">
  VC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具与项目" class="dropdown-title"><span class="title">工具与项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/" class="nav-link">
  工具
</a></li><li class="dropdown-item"><!----> <a href="/projects/" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="杂谈" class="dropdown-title"><span class="title">杂谈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/diary/" class="nav-link">
  日记
</a></li><li class="dropdown-item"><!----> <a href="/others/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多vuepress" class="dropdown-title"><span class="title">vuepress</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/guide/" class="nav-link">
  指南
</a></li><li class="dropdown-subitem"><a href="/vue/config/" class="nav-link">
  配置
</a></li></ul></li><li class="dropdown-item"><h4>
          主题与插件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/plugin/" class="nav-link">
  插件
</a></li><li class="dropdown-subitem"><a href="/vue/theme/" class="nav-link">
  主题
</a></li></ul></li><li class="dropdown-item"><h4>
          API
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/api/cli.html" class="nav-link">
  CLI
</a></li><li class="dropdown-subitem"><a href="/vue/api/node.html" class="nav-link">
  Node
</a></li></ul></li><li class="dropdown-item"><h4>
          开发指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/miscellaneous/local-development.html" class="nav-link">
  本地开发
</a></li><li class="dropdown-subitem"><a href="/vue/miscellaneous/design-concepts.html" class="nav-link">
  设计理念
</a></li><li class="dropdown-subitem"><a href="/vue/faq/" class="nav-link">
  FAQ
</a></li><li class="dropdown-subitem"><a href="/vue/miscellaneous/glossary.html" class="nav-link">
  术语
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about.html" class="nav-link">
  关于我
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/zjgcjy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/ctf/writeup/" aria-current="page" class="sidebar-link">writeup是什么</a></li><li><a href="/ctf/writeup/2017-cumtctf-final-writeup.html" class="sidebar-link">2017-cumt校赛writeup</a></li><li><a href="/ctf/writeup/2018-cumtctf-final-writeup.html" aria-current="page" class="active sidebar-link">2018校赛逆向出题思路</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#a-piece-of-cake-50" class="sidebar-link">A piece of cake - 50</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#解法" class="sidebar-link">解法</a></li></ul></li><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#uncomplicated-50" class="sidebar-link">Uncomplicated - 50</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#解法-2" class="sidebar-link">解法</a></li></ul></li><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#re0-beginning-100" class="sidebar-link">re0: beginning - 100</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#解法-3" class="sidebar-link">解法</a></li></ul></li><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#stay-in-observation-150" class="sidebar-link">Stay in observation - 150</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#解法-4" class="sidebar-link">解法</a></li></ul></li><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#shuttle-200" class="sidebar-link">Shuttle - 200</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#解法-5" class="sidebar-link">解法</a></li></ul></li><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#symmetric-cipher-250" class="sidebar-link">Symmetric Cipher - 250</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#解法-6" class="sidebar-link">解法</a></li></ul></li><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#windows-cracker-300" class="sidebar-link">Windows Cracker - 300</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ctf/writeup/2018-cumtctf-final-writeup.html#解法-7" class="sidebar-link">解法</a></li></ul></li></ul></li><li><a href="/ctf/writeup/2019-04-BlueCTF-writeup.html" class="sidebar-link">2019年4月BlueCTF writeup</a></li><li><a href="/ctf/writeup/2019-05-YellowCTF-writeup.html" class="sidebar-link">2019年5月YellowCTF writeup</a></li><li><a href="/ctf/writeup/2019-anheng-writeup.html" class="sidebar-link">2019安恒月赛一月赛writeup</a></li><li><a href="/ctf/writeup/2019-ins-hacker-reverse-writeup.html" class="sidebar-link">2019INS逆向writeup</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><hr> <blockquote><p>初赛刚刚结束，总体来说，这一次比赛re的难度不大，后面几个题难度也只是中等偏容易。我主要考虑到受众有许多17级的同学(可能是想多了-_-)，出这几个题目的时候，没有为难大家。本来以为后面几个题能困倒大家，没想到还是有大佬冲了出来，倍感欣慰，看来我差不多也该退役了。以下是我出题的思路：</p></blockquote> <ul><li><strong>多框架</strong></li> <li><strong>多语言</strong></li> <li><strong>算法简单</strong></li> <li><strong>解法多样</strong></li> <li><strong>32位Release版本</strong></li> <li><strong>无加壳保护</strong></li> <li><strong>无混淆代码</strong></li> <li><strong>基本无反调试</strong></li></ul> <h2 id="a-piece-of-cake-50"><a href="#a-piece-of-cake-50" class="header-anchor">#</a> A piece of cake - 50</h2> <blockquote><p><strong>As the title said. Nothing else.</strong></p></blockquote> <p><code>VS2012编译 C语言 Release版本 32位</code></p> <p>签到题，不用多说吧。</p> <h3 id="解法"><a href="#解法" class="header-anchor">#</a> 解法</h3> <p>解法如下图所示，或者你用IDA之类的逆向工具打开就能看到了。</p> <p>(若有童鞋不懂稍微讲一下：将输入字符串和flag进行比较，正确就Congratulations)</p> <p><img src="/img/2018-08/Snipaste_2018-01-14_22-48-08.png" alt="re1"></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>cumtctf<span class="token punctuation">{</span>We1cOme_t0_cUmtCtf_IeVe1_0ne_SO_eaSy<span class="token operator">!</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="uncomplicated-50"><a href="#uncomplicated-50" class="header-anchor">#</a> Uncomplicated - 50</h2> <blockquote><p><strong>Probably, this is the most common algorithm in software reversing.</strong></p></blockquote> <p><code>VS2012编译 C语言 Release版本 32位</code></p> <p>入门签到题，如果是刚入门的同学的话，第一次做这个可能有点吃力。正如题目所说的，该算法是逆向工程中最常见的算法，其实更是密码学最常见算法之一，那就是异或⊕或者叫模2加法，其基于的原则就是 二进制不带进位加法运算：</p> <ul><li><strong>0+1=1</strong></li> <li><strong>0+0=0</strong></li> <li><strong>1+0=1</strong></li> <li><strong>1+1=0</strong></li></ul> <p>回到题目中来，我们直接使用IDA分析程序，自动分析完成后，因为大部分同学不懂汇编，这里我就直接F5看伪C代码了。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_10-14-02.png" alt="re2"></p> <p>上图所示的是输入部分，可以看到对输入字符串的每一个值循环和i进行异或操作，将结果保存在<code>cinXor</code>中。下面将判断输入的字符串是否正确。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_10-21-33.png" alt="re2"></p> <p>上图所示的就是比较的部分，实际上这段代码是<code>memcmp</code>函数的具体实现。先取出两个数组的首地址，逐个比较，变量每次加四代表比较的大小是一次32位，也就是4字节。最后才进入<code>if</code>判断条件，比较最后2个，所以很明显，比较长度是4的倍数余2。</p> <h3 id="解法-2"><a href="#解法-2" class="header-anchor">#</a> 解法</h3> <p>为了获取需要对比的字符串，我们查看该flag变量。如下图所示。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_10-30-50.png" alt="re2"></p> <p>现在我们需要做的就是将该数组的每个值，和i异或就行了。用python写脚本求解。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#coding:utf-8</span>
__author__ <span class="token operator">=</span> <span class="token string">'zjgcjy'</span>

flag <span class="token operator">=</span><span class="token string">''</span>
strXor <span class="token operator">=</span> <span class="token string">&quot;\x63\x74\x6f\x77\x67\x71\x60\x7c\x50\x39&quot;</span> \
         <span class="token string">&quot;\x78\x54\x3d\x7e\x51\x6c\x20\x7c\x5f\x5c&quot;</span> \
         <span class="token string">&quot;\x7a\x4a\x22\x79\x7c\x46\x74\x2b\x68\x42&quot;</span> \
         <span class="token string">&quot;\x76\x2b\x52\x45\x7d\x51\x15\x42\x4e\x53\x17\x54&quot;</span>

<span class="token keyword">for</span> index<span class="token punctuation">,</span> ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>strXor<span class="token punctuation">)</span><span class="token punctuation">:</span>
	flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>index <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> flag
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>由此得到flag。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>cumtctf<span class="token punctuation">{</span>X0r_1s_c0mMOn_4nd_n0t_h4rd_r1ght?<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="re0-beginning-100"><a href="#re0-beginning-100" class="header-anchor">#</a> re0: beginning - 100</h2> <blockquote><p><strong>Watch out the order please.</strong></p></blockquote> <p><code>VS2012编译 C语言 Release版本 32位</code></p> <p>这题才算是一个逆向的题目，不过也很简单，平时比赛的话最高50分。
使用IDA分析好了。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_10-52-53.png" alt="re3"></p> <p>就主函数中对输入进行了操作，通过上图我们可以看到，当输入字符串长度是36时，将每四个作为一组。高位的作为高位，低位的作为低位。意思就是说，将4个8bit的char变量转成1个32bit的int变量，其中高地址存放高字节，而且左移8位不会影响其低字节，最后和<code>0x12341234</code>异或，再和flag进行比较。然后我们来查看一下flag变量。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_11-02-52.png" alt="re3"></p> <h3 id="解法-3"><a href="#解法-3" class="header-anchor">#</a> 解法</h3> <p>知道了过程写脚本就容易了。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#coding:utf-8</span>
__author__<span class="token operator">=</span><span class="token string">'zjgcjy'</span>
<span class="token keyword">import</span> binascii

array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x75557E52</span><span class="token punctuation">,</span><span class="token number">0x2351454F</span><span class="token punctuation">,</span><span class="token number">0x57592257</span><span class="token punctuation">,</span><span class="token number">0x4D7B466B</span><span class="token punctuation">,</span><span class="token number">0x4D515A40</span><span class="token punctuation">,</span><span class="token number">0x77427766</span><span class="token punctuation">,</span><span class="token number">0x7C582746</span><span class="token punctuation">,</span><span class="token number">0x22434D53</span><span class="token punctuation">,</span><span class="token number">0x6F503346</span><span class="token punctuation">]</span>
result <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	result <span class="token operator">+=</span> binascii<span class="token punctuation">.</span>a2b_hex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x12341234</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span> result
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>由此得到flag。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>flag<span class="token punctuation">{</span>We1c0mE_TO_tHe_Rever5lng_w0r<span class="token operator">!</span>d<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="stay-in-observation-150"><a href="#stay-in-observation-150" class="header-anchor">#</a> Stay in observation - 150</h2> <blockquote><p><strong>Well, you ought to be familiar with this language.</strong></p></blockquote> <p><code>VS2012编译 C# .Net Framework4.0 Release版本 64位</code></p> <p>这是一道.Net逆向，考虑到很多同学没有接触过C#，所以我给了150分，其实和Java是差不多的，一个是CLR，一个是JVM。其中的算法也很简单，我没用加壳进行保护，所以用.Net的工具就能直接看到源码了，甚至能动态调试。做出来这道题目的同学主要的思路有2种，和我预想的差不多。</p> <ul><li>使用动态调试，获取鼠标的位置，根据题目手动修改，之后自动解密出flag。</li> <li>不用动态调试，直接看后面的解密代码，发现是AES，写脚本解出flag。</li> <li>既使用调试，同时又跟踪AES，最后发现，flag被自动解出来了。WoW!</li></ul> <h3 id="解法-4"><a href="#解法-4" class="header-anchor">#</a> 解法</h3> <p>调试的方式我就不说了，这里我将一下第二种方式。题目我是用了一张图片，检测鼠标的点击事件，当点击三次后。进行判断，点击的位置和规定的位置是否相同，这里的3个位置是我随机选的，所以用户点击一次就成功的可能性是个极小概率事件，更别说3次了。当判断不同时，直接弹框失败，否则进入MIX类中的Crypt方法进行解密。下面我们来看一下这个MIX类。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_11-28-17.png" alt="re4"></p> <p>可以看到，该类中定义了一个计算MD5的方法，和一个解密的方法，当然还有一共byte转string的方法，这里没有列出来。其实这个MD5方法根本没有用到，就是混淆视听用的，而下面的<code>System.Security.Cryptography.RijndaelManaged</code>类就是Rijndael密码算法，也就是AES。下面直接写脚本解AES就行了。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#coding:utf-8</span>
@需要Crypto库支持
__author__<span class="token operator">=</span><span class="token string">'zjgcjy'</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> base64 <span class="token keyword">import</span> <span class="token operator">*</span>

IV <span class="token operator">=</span> <span class="token string">&quot;Oityj1sok1yksiWeqtddYQ==&quot;</span>
key <span class="token operator">=</span> <span class="token string">&quot;epWRCdxC79zuea4ZnxEacCMMmIzo0tn/Ah+ENEWOYOY=&quot;</span>
c <span class="token operator">=</span> <span class="token string">&quot;NAaswR+u94wyIGDUifYSIfznIt0VXoR/NWoJoSjyWJ0=&quot;</span>

cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>b64decode<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> b64decode<span class="token punctuation">(</span>IV<span class="token punctuation">)</span><span class="token punctuation">)</span>
plain <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>b64decode<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> plain
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>注意该AES有IV，可能是CBC、CFB、OFB三种模式，而在C#中，有IV情况下又未指定模式，一般是指CBC模式，由此得到flag。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>flag<span class="token punctuation">{</span>reVer5e_1n_C5harP_or_ae5<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="shuttle-200"><a href="#shuttle-200" class="header-anchor">#</a> Shuttle - 200</h2> <blockquote><p><strong>Randomization is not terrible, trust me.</strong></p></blockquote> <p><code>VS2012编译 C语言 Release版本 32位</code></p> <p>C语言写的控制台程序，直接用IDA吧，打开后主函数流程如下。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_12-35-13.png" alt="re5"></p> <p>先输入字符串，没什么好说的，但是看下面。很明显，这里用了<code>rand</code>函数，同时加入了时间作为种子，产生4个伪随机数作为密钥<code>key</code>。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_12-35-38.png" alt="re5"></p> <p>再来看接下来的步骤，用随机的key当作密钥流和数组进行异或，最后和<code>flag</code>进行比较，若相等则Congratulations。
所以我们要做的就是爆破一个4字节的key，然后和原始数组进行亦或，最后得到一个有意义的字符串。脚本如下。</p> <h3 id="解法-5"><a href="#解法-5" class="header-anchor">#</a> 解法</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># coding:utf-8</span>
__author__<span class="token operator">=</span><span class="token string">'zjgcjy'</span>
<span class="token keyword">import</span> re
<span class="token keyword">import</span> string
<span class="token keyword">import</span> itertools <span class="token keyword">as</span> its
<span class="token comment">#[0-9a-zA-Z_]{23,}</span>
words <span class="token operator">=</span> string<span class="token punctuation">.</span>lowercase
table <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0xb</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">]</span>
r <span class="token operator">=</span> its<span class="token punctuation">.</span>product<span class="token punctuation">(</span>words<span class="token punctuation">,</span>repeat<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> r<span class="token punctuation">:</span>
	key <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
	flag <span class="token operator">=</span><span class="token string">&quot;&quot;</span>
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'[0-9a-zA-Z_?]{24,}'</span><span class="token punctuation">,</span>flag<span class="token punctuation">)</span> <span class="token keyword">and</span> flag<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token punctuation">:</span>
		<span class="token keyword">print</span> key<span class="token punctuation">,</span>flag
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>有几点需要注意。</p> <ul><li>key一般是可见字符，而后期我放了提示说key是字母，这里爆破的范围可以减少，可以分别爆破小写和大写尝试。</li> <li>更明显的是，<code>flag</code>中只会包含数字、大小写字母和以下划线为代表的特殊字符，所以这里可以结合正则表达式求解。</li> <li>正则表达式的条件不唯一，这里也需要试多次，一开始可以试<code>[0-9a-zA-Z_]{23,}</code>，发现最后一位只有<code>=&gt;?</code>三种情况了，再分别尝试，同时可以结合下划线出现次数来提高效率。</li></ul> <p>最后得到flag如下。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>flag<span class="token punctuation">{</span>RandOm_1s_u5eleSs_Isit_?<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="symmetric-cipher-250"><a href="#symmetric-cipher-250" class="header-anchor">#</a> Symmetric Cipher - 250</h2> <blockquote><p><strong>Have you ever heard of Microsoft Foundation Classes ?</strong></p></blockquote> <p><code>VS2017编译 MFC 静态链接 Release版本 32位</code></p> <p>这道题是一个MFC的程序，由于是静态链接，程序体积很大，有3MB多。在如此大量的代码下能找到关键的Check函数是比较重要的。
这里我贴上关于MFC如何交叉应用查找控件ID的方法，也是由唐师傅在暑假培训的时候讲过的内容。想要深入的同学需要自己学习了，这里我就详细讲了。</p> <p><a href="http://blog.csdn.net/SilverMagic/article/details/40621107" target="_blank" rel="noopener noreferrer">基于MFC的教程1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://blog.csdn.net/SilverMagic/article/details/40622413" target="_blank" rel="noopener noreferrer">基于MFC的教程2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://blog.csdn.net/SilverMagic/article/details/40623299" target="_blank" rel="noopener noreferrer">基于MFC的教程3<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="解法-6"><a href="#解法-6" class="header-anchor">#</a> 解法</h3> <p>现在我们打开IDA，追踪到该关键函数。IDA自动生成的<code>sub_402510</code>函数则是<code>确定</code>按钮点击的消息处理，但是一开始<code>确定</code>按钮是点击不了的，原因是长度不满足条件，具体的条件则在<code>sub_4024C0</code>中，如下图所示。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_16-07-52.png" alt="re6"></p> <p>也就是说，当输入字符串长度是30的时候，<code>确定</code>按钮将被激活，即flag长度是30。</p> <p>所以现在我们再来看<code>sub_402510</code>函数的流程。如下图所示。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_16-13-20.png" alt="re6"></p> <p>可以看到，点击<code>确定</code>后，首先进行反调试，若程序正在被调试，则直接退出。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>mov     ebx, large fs:30h
mov     eax, <span class="token punctuation">[</span>ebx+68h<span class="token punctuation">]</span>
<span class="token function">cmp</span>     eax, 70h
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>关于该反调试的原理，很简单。相当于是自己实现简单的反调试检测，和微软的API接口<code>IsDebuggerPresent()</code>有点不同的是：<code>IsDebuggerPresent()</code>是通过访问程序PEB的<code>BeingDebugged</code>标志检测反调试。而该段汇编是通过检测<code>NTGlobalFlag</code>，是PEB结构偏移量0x68处的一个未公开位置，该位置决定了程序在调试和正常情况下不同的创建内存堆的方式。如果是0x70，则程序正在被调试。要跳过的方式很简单，直接nop判断方法或者改跳转(汇编模式下操作)。当然这个题我不是考大家这个的。我们直接进入<code>Check</code>函数好了。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_16-37-39.png" alt="re6"></p> <p>有点基础的同学进入这个函数就能发现下面会有一个rc4的加密。而密钥流由<code>National_Basketball_Association</code>来生成。这里我就不多说了，上面的截图是rc4的KSA函数，先将密钥流初始化，再进行混乱。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_16-42-45.png" alt="re6"></p> <p>接下来就是rc4的第二部分，伪随机生成密钥流并和字符串进行异或，得到密文。如上图所示。之后的代码就是比较了，这里不多说了。
由于rc4加密和解密是同一个函数，解密时，我们只需要将密文通过同一个key即可恢复得到明文了。下面是程序中的常量字符串，可能有童鞋没找到，我这里列出来了。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_13-38-49.png" alt="re6"></p> <p>这里我直接引用Orzk队的脚本了，也可以自己写，不是很难。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_16-59-20.png" alt="re6"></p> <p>最后得到flag如下。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>cumtctf<span class="token punctuation">{</span>Mfc_1s_VerY_difflcUIt<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="windows-cracker-300"><a href="#windows-cracker-300" class="header-anchor">#</a> Windows Cracker - 300</h2> <blockquote><p><strong>Would you want to be a Windows craker ? Try your best !!!</strong></p></blockquote> <p><code>VS2012编译 Windows 动态链接 Release版本 32位</code></p> <p>最后一题是一个Windows下的GUI程序，程序本身很简单，就是弹出一个对话框，根据输入计算flag。主要还是找到Check函数，但是这个程序本身很小，你也可以一个一个找，很快也能找到-_-。关于Win32程序是如何加载的，推荐大家看windows系列的书籍，里面会详细讲。我简单说明一下。首先看一下程序中所有的字符串常量，相关的函数也可以在这里查找交叉引用。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_17-54-06.png" alt="re7"></p> <p>其次我们从主函数开始分析。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_17-03-13.png" alt="re7"></p> <p>要注意，GUI程序是从WinMain开始的，首先是定义注册窗口类并调用<code>RegisterClassW()</code>，其次就可以依据该窗口类来创建窗口，调用<code>CreateWindowExW()</code>，之后开始进入整个消息循环中，进行消息的分发与更新。而整个框架中最重要的是注册窗口类的回调函数，也就是窗口过程。他是<code>tagWNDCLASSW</code>结构体中的<code>lpfnWndProc</code>，函数类型为<code>WNDPROC</code>。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_17-56-06.png" alt="re7"></p> <p>窗口过程的参数与分别是窗口句柄，消息标识符，2个DWORD的消息参数。在这个程序中，窗口过程首先接受<code>WM_CREATE</code>消息，进行窗口控件的创建，即上图中的<code>case 1</code>的情况，创建了一个文本框和一个确定按钮。对于确定按钮，定义了HMENU参数是250。控件ID和HMENU是共用的，当作为子窗口时，往往不需要菜单，该值用来区分控件。而对于接受到的按钮子窗口的<code>WM_COMMAND</code>消息，<code>wParam</code>参数的低位是子窗口ID，高位是消息，lParam参数是接收消息的子窗口的句柄。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_17-58-26.png" alt="re7"></p> <p>一句话，也就是说在点击按钮后，产生<code>wParam</code>消息的低位是250，直接进入<code>sub_401350()</code>函数中进行判断。下面我们来看一下这个函数。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_18-22-26.png" alt="re7"></p> <p>可以看到，直接调用<code>GetWindowTextA()</code>API来判断输入长度，当输入长度不是41的时候，直接通过<code>SendMessageW()</code>向窗口过程发送消息，且<code>wParam</code>参数是1111，我们回到窗口过程可以看到，此时会直接调用<code>MessageBoxW(hWnd, L&quot;flag错误&quot;, L&quot;FAIL&quot;, 0x40u)</code>即弹框，flag错误。所以我们可以确定flag长度就是41。接下来进入核心的Check函数验证算法。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_18-30-49.png" alt="re7"></p> <p>看着很简单，其实不然。其中的<code>loc_401050</code>是一大段汇编，由于IDA反汇编插件出错，是需要看汇编的。</p> <p><strong>这种情况经常会有，请大家习惯看汇编，而且F5经常会出错</strong></p> <p>当然这题是我手动造成的情况，由于IDA采用了递归下降的扫描方式，想要让其出错并不难。请大家自己移步到链接。</p> <p><a href="http://blog.csdn.net/breaksoftware/article/details/7893422" target="_blank" rel="noopener noreferrer">线性扫描算法分析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://blog.csdn.net/breaksoftware/article/details/7893871" target="_blank" rel="noopener noreferrer">递归下降算法分析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>知道了这些后，直接nop部分指令就行了。出错的位置是<code>.text:00401050</code>和<code>.text:004010B6</code>，之后需要手动建立函数。最后函数流程如下图所示。发现就是不停的取第二个参数的2个值，然后相加放在第一个参数列表中。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_18-53-20.png" alt="re7"></p> <p>下面我们重新回到Check函数，重新反编译，如下图所示。</p> <p><img src="/img/2018-08/Snipaste_2018-01-15_18-54-24.png" alt="re7"></p> <p>第一步，进入第一个函数<code>sub_401000</code>分析。这里我就不贴图了，这个函数没有什么实质的作用，就是把原来的字符串进行打乱，类似于第二个密钥是0的仿射密码，左右两端同时进行。<strong>cinShuttle[(i * 33) % 41] = cin[(i * 23) % 41]</strong>
打乱后进入第二个函数，而第二个函数就是不停的相加，就结束了。最后是用<code>strcmp</code>和flag进行对比。</p> <h3 id="解法-7"><a href="#解法-7" class="header-anchor">#</a> 解法</h3> <p>既然核心的算法都求出来了，逆向就变得比较简单了，所以我们就是要先逆向<code>sub_401050()</code>这个函数，之后再将顺序还原。</p> <ul><li>第二个函数创建了41个加法等式，就构成了一个41元一次方程组，且线性无关，只有唯一解。只需要解方程即可。</li> <li>第一个函数的逆向，如果看出来是单表代换密码，直接求33模41的逆元和23模41的逆元，即可还原明文。
<ul><li>如果看不懂移位怎么逆向，直接输入有序数组，动态调试，打印出结果，构建一一映射关系。</li> <li>如果即看不懂，也不会动态调试，那就直接爆破，在不考虑逆元是否存在的条件下，也只需要爆破41*41次。</li></ul></li></ul> <p>下面贴出我的解法，这里解41元方程组使用python的z3库来求解，当然同样可以使用Mathematica，或者python的numpy库来求解。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#coding:utf-8</span>
__author__<span class="token operator">=</span><span class="token string">'zjgcjy'</span>
<span class="token keyword">import</span> binascii
<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">solver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	res <span class="token operator">=</span> <span class="token string">''</span>
	cipher <span class="token operator">=</span> <span class="token string">&quot;97b1c8cdd5d29694b8b4c5daa471718fbe94a4d0def3d5d4d4c4d9e5c1c4d5daf4e7c1bed7c196646a&quot;</span>
	mat <span class="token operator">=</span> <span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string">'mat%d'</span><span class="token operator">%</span> i<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
	auth <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> binascii<span class="token punctuation">.</span>a2b_hex<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">]</span>
	s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
	s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>And<span class="token punctuation">(</span>
		auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		auth<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">==</span> mat<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> mat<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0x20</span><span class="token punctuation">)</span>
		s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0x80</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">)</span><span class="token punctuation">:</span>
		m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>mat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span> res

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
	main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>通过z3求解出结果是<code>cao1iutIP_mlv_Ct0eyacn_0Nt5eU_f!q_h{}USeA</code>。再求出33和23模41的逆元分别是5和-16，还原即可。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	mat <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
	str1 <span class="token operator">=</span> <span class="token triple-quoted-string string">r'''cao1iutIP_mlv_Ct0eyacn_0Nt5eU_f!q_h{}USeA'''</span>
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		mat<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">41</span><span class="token punctuation">]</span> <span class="token operator">=</span> str1<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">41</span><span class="token punctuation">]</span>
	<span class="token keyword">print</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>mat<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>最后得到flag。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>cumtctf<span class="token punctuation">{</span>Ai_CaN_he1P_y0U_SoIve_eqUatl0n5<span class="token operator">!</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">2020年5月21日 08:48</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ctf/writeup/2017-cumtctf-final-writeup.html" class="prev">
        2017-cumt校赛writeup
      </a></span> <span class="next"><a href="/ctf/writeup/2019-04-BlueCTF-writeup.html">
        2019年4月BlueCTF writeup
      </a>
      →
    </span></p></div>  <!----></main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.c384680d.js" defer></script><script src="/assets/js/9.1b3f6a17.js" defer></script><script src="/assets/js/3.3518c87f.js" defer></script><script src="/assets/js/49.bacdf275.js" defer></script><script src="/assets/js/5.94903e8d.js" defer></script>
  </body>
</html>
