(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{540:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("学习笔记，结合官方文档和网上资料整理，加强理解\n从angr第二章第五节开始 模拟管理器")])]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("在angr中最重要的控制接口就是模拟管理器，它允许你同时控制状态组的符号执行。应用搜索策略来探索程序的状态空间。在这里，您将学习如何使用它。\n模拟管理器允许你对状态进行多种操作，状态被组织成许多不同的stashes，你可以前进，分类，合并，或者移动。默认的状态是active，这是初始化新模拟管理器时的状态。")]),t._v(" "),a("h2",{attrs:{id:"stepping"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stepping"}},[t._v("#")]),t._v(" stepping")]),t._v(" "),a("p",[t._v("状态模拟器最基本的功能，就是使程序向前移动一个基本代码块。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("In "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("82")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" proj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("83")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimulationManager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" active"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\nIn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("active\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("84")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimState @ "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x400580")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nIn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("85")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("step"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("85")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimulationManager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" active"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\nIn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("86")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("active\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("86")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimState @ "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x400540")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("当然，这个模型最有用的地方在于，如果一个状态遭遇到了符号分支条件，后继都会出现在stash中，我们可以同步的运行他们。当你不需要很仔细地分析控制流的时候，可以使用run方法。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用until参数。")]),t._v("\nIn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("until"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("active"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWARNING "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("02")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("513")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" angr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state_plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("symbolic_memory "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Register r12 has an unspecified value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Generating an unconstrained value of "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nWARNING "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("02")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("169")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" angr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state_plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("symbolic_memory "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Memory address "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x7ffffffffff0000")]),t._v(" has an unspecified value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Generating an unconstrained value of "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nWARNING "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("02")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("170")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" angr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state_plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("symbolic_memory "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Memory address "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x7fffffffffeff70")]),t._v(" has an unspecified value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Generating an unconstrained value of "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimulationManager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" active"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("当这个例子运行完后，我们会有3个死亡stashes。当一个状态不能再产生任何后继时，比如遇到了终止函数，它将被从active的stashes中移除，然后被放置到deadended stashes中。")]),t._v(" "),a("h2",{attrs:{id:"stashes管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stashes管理"}},[t._v("#")]),t._v(" stashes管理")]),t._v(" "),a("p",[t._v("使用move来在不同stashes中移动，"),a("code",[t._v(".move()")]),t._v("参数有从哪个stash"),a("code",[t._v("from_stash")]),t._v("，到哪个stash"),a("code",[t._v("to_stash")]),t._v("，和过滤函数"),a("code",[t._v("filter_func")]),t._v("可选，默认全部。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("In "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("124")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("move"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("from_stash"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"active"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" to_stash"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"authenticated"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" filter_func"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('b"Welcome"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("posix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dumps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("124")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimulationManager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" authenticated"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v('我们刚啊创建了一个新的stash叫做"authenticated"，通过过滤标准输出流中具有"Welcome"字符串，这是一个非常好的标准。')]),t._v(" "),a("p",[t._v("访问stash的方法一般是通过下标来进行，但是这里也有很多其他方法，比如通过前缀"),a("code",[t._v("one_")]),t._v("，这表示将访问某个statsh中的第一个值。如果我们使用"),a("code",[t._v("mp_")]),t._v("，这将返回一个statsh的集合结果mulpyplexed。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("In "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("139")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("one_authenticated\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("139")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimState @ "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x1000080")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\nIn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("140")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mp_authenticated\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("140")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" MP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimState @ "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x1000080")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimState @ "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x1000080")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nIn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("141")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mp_authenticated"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("posix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dumps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("141")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" MP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("b'Username: \\nPassword: \\nWelcome to the admin console, trusted user!\\n'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("b'Username: \\nPassword: \\nWelcome to the admin console, trusted user!\\n'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[t._v("当然，"),a("code",[t._v("step")]),t._v(", "),a("code",[t._v("run")]),t._v("都可以指定一个单独的statsh，使用statsh参数即可。更多做法参见API表。")]),t._v(" "),a("h2",{attrs:{id:"stash-类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stash-类型"}},[t._v("#")]),t._v(" stash 类型")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("Stash")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("active")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("这个stash包含了默认单步执行的结果，除非你指定了其他的stash。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("deadended")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("一个状态走向结束，因为某些原因不能再执行下去，比如指令无效，后继不能被解决，或者一个无效的指令指针。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("pruned")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("When using "),a("code",[t._v("LAZY_SOLVES")]),t._v(", states are not checked for satisfiability unless absolutely necessary. When a state is found to be unsat in the presence of "),a("code",[t._v("LAZY_SOLVES")]),t._v(", the state hierarchy is traversed to identify when, in its history, it initially became unsat. All states that are descendants of that point (which will also be unsat, since a state cannot become un-unsat) are pruned and put in this stash.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("unconstrained")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("如果"),a("code",[t._v("save_unconstrained")]),t._v("选项被提供给模拟管理器，状态就是无约束的。由用户数据或其他符号数据源控制的指令指针。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("unsat")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("如果"),a("code",[t._v("save_unsat")]),t._v("选项被提供给模拟管理器，那些不可解的状态将被放置在这个statsh中。")])])])]),t._v(" "),a("p",[t._v("这还有一个不属于stash的状态列表，"),a("code",[t._v("errored")]),t._v("，如果在执行过程中，抛出异常，状态将被包装成一个"),a("code",[t._v("ErrorRecord")]),t._v("对象。其中包含了状态和抛出的错误，这个记录将被添加到"),a("code",[t._v("errored")]),t._v("中。你可以在错误发生的地方就获取到状态的信息，通过"),a("code",[t._v("record.state")]),t._v("，或者我们可以查看错误信息"),a("code",[t._v("record.error")]),t._v("，你也可以通过"),a("code",[t._v("record.debug()")]),t._v("启动一个终端来调试这个错误。")]),t._v(" "),a("h3",{attrs:{id:"简单探测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单探测"}},[t._v("#")]),t._v(" 简单探测")]),t._v(" "),a("p",[t._v("一个极其普遍的方法在符号执行中，就是去找到一个状态，是能到达一个给定的地址。然后丢弃另一个状态的所有地址，模拟管理器也提供了这种模式，通过"),a("code",[t._v(".explore()")]),t._v("方法。\n当通过"),a("code",[t._v(".explore()")]),t._v("启动时，我们需要"),a("code",[t._v("find")]),t._v("参数。程序会执行，知道找到匹配的情况，这可以是需要停止的指令地址、一个列表的地址、或者是一个函数，它接受一个状态并返回它是否满足某些条件。当active stash中有状态满足后，他们将被放置在"),a("code",[t._v("found")]),t._v("stash中，并且执行结束。你之后就可以寻找想要的状态，然后决定是否需要继续。\n我们也可以指定一个"),a("code",[t._v("avoid")]),t._v("条件，和"),a("code",[t._v("find")]),t._v("格式相同。当状态匹配到避免条件时，它会被放在"),a("code",[t._v("avoided")]),t._v(" stash中，但是程序继续运行。最终，"),a("code",[t._v("num_find")]),t._v("参数控制了在返回以前应该被找到的状态个数，默认情况下是一个。当然，如果在找到目标情况之前就没有新的状态可用了，程序会退出。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("proj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" angr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Project"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'examples/CSCI-4968-MBE/challenges/crackme0x00a/crackme0x00a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsimgr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" proj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nsimgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("explore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("find"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('b"Congrats"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("posix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dumps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SimulationManager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" active"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" found"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\ns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" simgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("found"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("posix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dumps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nEnter password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Congrats!\n\nflag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("posix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dumps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ng00dJ0B!\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("h2",{attrs:{id:"探索技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#探索技术"}},[t._v("#")]),t._v(" 探索技术")]),t._v(" "),a("p",[t._v("angr附带了一些固定的功能，允许您自定义模拟管理器的行为，称为探索技术。为什么需要探索技术的典型例子是修改探索程序状态空间的模式，默认的“一次完成所有步骤”策略实际上是广度优先搜索。但是通过探索技术，您可以实现，例如，深度优先搜索。然而，这些技术的检测能力要灵活得多，您可以完全改变angr的步进过程的行为。编写您自己的探索技术将在后面的章节中介绍。\n为了使用探索技术，调用"),a("code",[t._v("simgr.use_technique(tech)")]),t._v(", 因为这些技术都是"),a("code",[t._v("ExplorationTechnique")]),t._v("的子类，angr内置的探索技术可以在"),a("code",[t._v("angr.exploration_techniques")]),t._v("中找到。")]),t._v(" "),a("p",[t._v("TODO:")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("DFS")]),t._v(":Depth first search, as mentioned earlier. Keeps only one state active at once, putting the rest in the "),a("code",[t._v("deferred")]),t._v(" stash until it deadends or errors.")]),t._v(" "),a("li",[a("em",[t._v("Explorer")]),t._v(":This technique implements the "),a("code",[t._v(".explore()")]),t._v(" functionality, allowing you to search for and avoid addresses.")]),t._v(" "),a("li",[a("em",[t._v("LengthLimiter")]),t._v(":Puts a cap on the maximum length of the path a state goes through.")]),t._v(" "),a("li",[a("em",[t._v("LoopSeer")]),t._v(": Uses a reasonable approximation of loop counting to discard states that appear to be going through a loop too many times, putting them in a "),a("code",[t._v("spinning")]),t._v(" stash and pulling them out again if we run out of otherwise viable states.")]),t._v(" "),a("li",[a("em",[t._v("ManualMergepoint")]),t._v(": Marks an address in the program as a merge point, so states that reach that address will be briefly held, and any other states that reach that same point within a timeout will be merged together.")]),t._v(" "),a("li",[a("em",[t._v("MemoryWatcher")]),t._v(": Monitors how much memory is free/available on the system between simgr steps and stops exploration if it gets too low.")]),t._v(" "),a("li",[a("em",[t._v("Oppologist")]),t._v(': The "operation apologist" is an especially fun gadget - if this technique is enabled and angr encounters an unsupported instruction, for example a bizzare and foreign floating point SIMD op, it will concretize all the inputs to that instruction and emulate the single instruction using the unicorn engine, allowing execution to continue.')]),t._v(" "),a("li",[a("em",[t._v("Spiller")]),t._v(": When there are too many states active, this technique can dump some of them to disk in order to keep memory consumption low.")]),t._v(" "),a("li",[a("em",[t._v("Threading")]),t._v(": Adds thread-level parallelism to the stepping process. This doesn't help much because of python's global interpreter locks, but if you have a program whose analysis spends a lot of time in angr's native-code dependencies (unicorn, z3, libvex) you can seem some gains.")]),t._v(" "),a("li",[a("em",[t._v("Tracer")]),t._v(": An exploration technique that causes execution to follow a dynamic trace recorded from some other source. The "),a("a",{attrs:{href:"https://github.com/angr/tracer",target:"_blank",rel:"noopener noreferrer"}},[t._v("dynamic tracer repository"),a("OutboundLink")],1),t._v(" has some tools to generate those traces.")]),t._v(" "),a("li",[a("em",[t._v("Veritesting")]),t._v(": An implementation of a "),a("a",{attrs:{href:"https://users.ece.cmu.edu/~dbrumley/pdf/Avgerinos%20et%20al._2014_Enhancing%20Symbolic%20Execution%20with%20Veritesting.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("CMU paper"),a("OutboundLink")],1),t._v(" on automatically identifying useful merge points. This is so useful, you can enable it automatically with "),a("code",[t._v("veritesting=True")]),t._v(" in the SimulationManager constructor! Note that it frequenly doesn't play nice with other techniques due to the invasive way it implements static symbolic execution.")])])])}),[],!1,null,null,null);s.default=e.exports}}]);