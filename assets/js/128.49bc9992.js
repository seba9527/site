(window.webpackJsonp=window.webpackJsonp||[]).push([[128],{576:function(s,a,e){"use strict";e.r(a);var t=e(14),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("hr"),s._v(" "),e("blockquote",[e("p",[s._v("讲一下docker的用法。\n关于ubuntu16.04安装最新docker的方法，参照官网手册。")])]),s._v(" "),e("h2",{attrs:{id:"拉取镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[s._v("#")]),s._v(" 拉取镜像")]),s._v(" "),e("p",[s._v("可以使用")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker search "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查找有关镜像\n然后使用")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker pull "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("拉取镜像")]),s._v(" "),e("h2",{attrs:{id:"查看镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看镜像"}},[s._v("#")]),s._v(" 查看镜像")]),s._v(" "),e("p",[s._v("查看所有镜像")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker images\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"启动镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动镜像"}},[s._v("#")]),s._v(" 启动镜像")]),s._v(" "),e("p",[s._v("有好几种启动方式。")]),s._v(" "),e("h3",{attrs:{id:"直接运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#直接运行"}},[s._v("#")]),s._v(" 直接运行")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker run ubuntu:14.04 /bin/echo "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello world'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这跟在本地直接执行 /bin/echo 'hello world' 几乎感觉不出任何区别。\n下面的命令则启动一个 bash 终端，允许用户进行交互。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker run -t -i ubuntu:14.04 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("其中， -t 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上， -i 则让容器的标准输入保持打开。")]),s._v(" "),e("h3",{attrs:{id:"守护态运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#守护态运行"}},[s._v("#")]),s._v(" 守护态运行")]),s._v(" "),e("p",[s._v("更多的时候，需要让 Docker 容器在后台以守护态（Daemonized）形式运行。此时，可以通过添加 -d 参数来实现。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker run -d ubuntu:14.04\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("容器启动后会返回一个唯一的 id，也可以通过 docker ps 命令来查看容器信息。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("要获取容器的输出信息，可以通过 docker logs 命令。")]),s._v(" "),e("h2",{attrs:{id:"关闭容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关闭容器"}},[s._v("#")]),s._v(" 关闭容器")]),s._v(" "),e("p",[s._v("可以使用")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker stop\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("来终止一个运行中的容器。\n此外，当Docker容器中指定的应用终结时，容器也自动终止。 对于只启动了一个终端的容器，通过 exit 命令或 Ctrl+d 来退出终端时，所创建的容器立刻终止。终止状态的容器可以用")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("看到。")]),s._v(" "),e("p",[s._v("处于终止状态的容器，可以通过")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("命令来重新启动。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker restart\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("命令会将一个运行态的容器终止，然后再重新启动它。")]),s._v(" "),e("h2",{attrs:{id:"进入容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#进入容器"}},[s._v("#")]),s._v(" 进入容器")]),s._v(" "),e("h3",{attrs:{id:"attach方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#attach方式"}},[s._v("#")]),s._v(" attach方式")]),s._v(" "),e("p",[s._v("当采用守护态启动容器时，使用attach可以附加到容器。\n通过docker ps查看id就可以附加到运行的容器。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker attach -itd 44fc0f0582d9  \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"exec方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exec方式"}},[s._v("#")]),s._v(" exec方式")]),s._v(" "),e("p",[s._v("docker在1.3.X版本之后还提供了一个新的命令exec用于进入容器，这种方式相对更简单一些，")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" --help  \n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 775c7c9ee1e1 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"拷贝文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#拷贝文件"}},[s._v("#")]),s._v(" 拷贝文件")]),s._v(" "),e("p",[s._v("cp命令用于主机和容器拷贝文件，防止每次都重建dockerfile。")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" foo.txt mycontainer:/foo.txt\ndocker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" mycontainer:/foo.txt foo.txt\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"pwn-dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pwn-dockerfile"}},[s._v("#")]),s._v(" pwn dockerfile")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("FROM ubuntu\nMAINTAINER zjgcjy\nLABEL "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zjgcjy_pwngame"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VERSION")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.0'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# x86_Support")]),s._v("\nRUN dpkg --add-architecture i386\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# update")]),s._v("\nRUN "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# install something basic")]),s._v("\nRUN "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y libc6:i386 libncurses5:i386 libstdc++6:i386"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y socat "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copy file")]),s._v("\nCOPY ./pwn /tmp/pwn\nCOPY ./flag.txtGOT-AND-PLT/tmp/\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# add user")]),s._v("\nRUN "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -U -m pwn\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rights configtion")]),s._v("\nRUN "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" root:pwn /tmp/flag.txt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" root:pwn /tmp/pwn\nRUN "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("750")]),s._v(" /tmp/pwn"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("740")]),s._v(" /tmp/flag.txt\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#WORKDIR /tmp/")]),s._v("\nCMD "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" -u pwn socat tcp-l:4444,fork exec:/tmp/pwn\nEXPOSE "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4444")]),s._v("\n\ndocker run -d -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:1111:4444 -t pwn\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("h2",{attrs:{id:"构建自定义镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建自定义镜像"}},[s._v("#")]),s._v(" 构建自定义镜像")]),s._v(" "),e("p",[s._v("编写完成Dockerfile之后，可以通过docker build命令来创建镜像。\n基本的格式为 docker build [选项]路径，该命令将读取指定路径下的Dockerfile，并将该路径下的所有内容发送给Docker服务端，由服务端来创建镜像。因此一般建议放置Dockerfile的目录为空目录")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("docker build -t pwn "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"删除images"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删除images"}},[s._v("#")]),s._v(" 删除images")]),s._v(" "),e("p",[s._v('1.停止所有的container，这样才能够删除其中的images：\ndocker stop $(docker ps -a -q)\n如果想要删除所有container的话再加一个指令：\ndocker rm $(docker ps -a -q)\n2.查看当前有些什么images\ndocker images\n3.删除images，通过image的id来指定删除谁\ndocker rmi <image id>\n想要删除untagged images，也就是那些id为<None>的image的话可以用\ndocker rmi $(docker images | grep "^<none>" | awk "{print $3}")\n要删除全部image的话\ndocker rmi $(docker images -q)')])])}),[],!1,null,null,null);a.default=n.exports}}]);